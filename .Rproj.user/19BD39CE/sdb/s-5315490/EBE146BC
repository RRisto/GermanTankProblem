{
    "contents" : "source(\"helpers.R\")\nlibrary(\"ggplot2\")\n#library(\"plyr\")\nlibrary(\"dplyr\")\nlibrary(\"shiny\")\nlibrary(\"reshape2\")\nshinyServer(function(input, output) {\n    dataInput<- reactive({\n        #if sample size is bigger than min production range,\n        #error message is displayed\n        validate(\n            need(input$production[1] >=input$num,\n                 \"Sample size can't be bigger than minimum value of tank production range.\n                 Please choose a higher minimum value for production range or smaller \n                 sample size.\"),\n            need(input$checkGroup !=\"\",\"Choose a model to display\")\n            )\n        simulation(min=input$production[1],\n                   max= input$production[2],\n                   n=input$num)\n    })\n    models= reactive({\n        as.list(input$checkGroup)\n    })\n    data.sub=reactive({\n        subset(dataInput(), variable %in% models())\n    })\n    #first plot\n    output$guess.plot <- renderPlot({\n        ggplot(data.sub(), aes(x=real, y=value))+\n            geom_jitter(aes(color=variable), alpha=0.5)+\n            geom_abline(intercept = 0, slope=1)+\n            ylab(\"Guess\")+\n            xlab(\"Actual number of tanks produced\")+\n            scale_colour_discrete(name=\"Model\")+\n            #ggtitle(\"Tank production vs guess\")+\n            theme_minimal()+\n            theme(legend.position=\"none\")+\n            theme(plot.title = element_text(size=20,lineheight=.8, face=\"bold\"))\n    })\n    #residuals plot\n    output$resids.plot <- renderPlot({\n        ggplot(data.sub(), aes(x=real, y=resids))+\n            geom_jitter(aes(color=variable), alpha=0.5)+\n            geom_abline(intercept = 0, slope=0)+\n            ylab(\"Guess - true number of tanks\")+\n            xlab(\"Actual number of tanks produced\")+\n            scale_colour_discrete(name=\"Model\")+\n            #ggtitle(\"Residuals\")+\n            theme_minimal()+\n            theme(plot.title = element_text(size=20,lineheight=.8, face=\"bold\"))\n    })\n    output$residuals <- renderTable({ resids(data.sub()) })\n})",
    "created" : 1427482868619.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3799486354",
    "id" : "EBE146BC",
    "lastKnownWriteTime" : 1427481644,
    "path" : "~/Minu asjad/Statistika, mudelid, excel/R/GermanTankProblem/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}