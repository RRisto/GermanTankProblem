{
    "contents" : "simulation <- function(min=10, max=100, n=10){\n    real=c()\n    third.guess=data.frame(NULL)\n    initial.guess=data.frame(NULL)\n    second.guess=data.frame(NULL)\n    resids1=data.frame(NULL)\n    resids2=data.frame(NULL)\n    resids3=data.frame(NULL)\n    #function for third guess\n    thirdModel = function(samp) {\n        max(samp) + max(samp)/length(samp) - 1\n    }\n    #simulation\n    x = seq(min, max, by=1)\n    minminus=min-1\n    for(i in x) {\n        trueTop = 1*i\n        real[i-minminus]=trueTop\n        for(j in 1:10) {\n            observeds = sample(1:trueTop, n)#every simulation we take\n            #randomly n samples\n            third.guess[i-minminus,j] = thirdModel(observeds)\n            initial.guess[i-minminus,j]=max(observeds)\n            second.guess[i-minminus,j]=max(observeds)*1.05\n            resids1[i-minminus,j] =initial.guess[i-minminus,j]-trueTop\n            resids2[i-minminus,j] =second.guess[i-minminus,j]-trueTop\n            resids3[i-minminus,j] =third.guess[i-minminus,j]-trueTop\n        }\n    }\n    #function for making data short, renaming levels\n    table=function(data, name){\n        data=data %>%\n            mutate( real=real) %>%\n            melt(id=\"real\") %>%\n            mutate(variable=name)\n        data\n    }\n    initial.guess=table(initial.guess, \"Model 1\")\n    second.guess=table(second.guess, \"Model 2\")\n    third.guess=table(third.guess, \"Model 3\")\n    resids1=table(resids1, \"resids1\")\n    resids2=table(resids2, \"resids2\")\n    resids3=table(resids3, \"resids3\")\n    #rbind tables\n    data.guess=rbind(initial.guess, second.guess, third.guess)\n    data.resids=rbind(resids1, resids2, resids3)\n    #add resids to initial table\n    data.guess$resids=data.resids$value\n    return(data.guess)\n}\n#function for creating residuals summary table\nresids=function(data){\n#     summary=ddply(data, \"variable\", summarize,\n#                   Mean=mean(resids),\n#                   Median=median(resids),\n#                   Sum=sum(resids))\n    summary=group_by(data, variable)\n    summary=summarise(summary,\n                      Mean=mean(resids),\n                      Median=median(resids),\n                      Sum=sum(resids))\n    names(summary)[1]=\"Model\"\n    summary\n}",
    "created" : 1427482867500.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "95550382",
    "id" : "8260598B",
    "lastKnownWriteTime" : 1427481644,
    "path" : "~/Minu asjad/Statistika, mudelid, excel/R/GermanTankProblem/helpers.R",
    "project_path" : "helpers.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}